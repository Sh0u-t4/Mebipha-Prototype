<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gi·ªè h√†ng - Mebipha</title>

  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="components.css">
  <link rel="stylesheet" href="layout.css">
</head>

<body>
  <!-- Header -->
  <header class="header" id="header">
    <div class="header-top">
      <div class="container">
        <div class="header-main-row">
          <!-- Logo -->
          <div class="header-logo">
            <a href="index.html" class="logo-link">
              <img src="images/logo.png" alt="Mebipha Logo" class="logo-img"
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="logo-text-wrapper">
                <span class="logo-brand">MEBIPHA</span>
                <span class="logo-slogan">GI·∫¢I PH√ÅP CHƒÇN NU√îI 4.0</span>
              </div>
            </a>
          </div>

          <!-- Search Bar -->
          <div class="header-search">
            <form class="search-form" onsubmit="handleSearch(event)">
              <input type="search" class="search-input" placeholder="T√¨m thu·ªëc, ho·∫°t ch·∫•t, ho·∫∑c b·ªánh l√Ω..."
                id="searchInput">
              <button type="submit" class="search-btn-custom">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"></circle>
                  <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                T√¨m ki·∫øm
              </button>
            </form>
          </div>

          <!-- Header Actions -->
          <div class="header-actions">
            <a href="#" class="action-item">
              <div class="action-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
              </div>
              <span class="action-text">K√ä ƒê∆†N ONLINE</span>
            </a>
            <a href="cart.html" class="action-item cart-btn-wrapper">
              <div class="action-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                <span class="cart-badge">0</span>
              </div>
              <span class="action-text">GI·ªé H√ÄNG</span>
            </a>

            <!-- Mobile Menu Button -->
            <button class="btn-icon mobile-menu-btn md:d-none" onclick="toggleMobileMenu()">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6" />
                <line x1="3" y1="12" x2="21" y2="12" />
                <line x1="3" y1="18" x2="21" y2="18" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation Bar -->
    <div class="header-nav-bar">
      <div class="container">
        <nav class="main-nav">
          <a href="index.html" class="main-nav-link">TRANG CH·ª¶</a>
          <a href="products.html" class="main-nav-link">C·ª¨A H√ÄNG</a>
          <a href="diseases.html" class="main-nav-link">TRA C·ª®U B·ªÜNH</a>
          <a href="news.html" class="main-nav-link">TIN T·ª®C</a>
          <a href="contact.html" class="main-nav-link">LI√äN H·ªÜ</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-content">
      <div class="mobile-menu-header">
        <span class="font-bold">Menu</span>
        <button class="btn-icon" onclick="toggleMobileMenu()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <nav class="mobile-nav">
        <a href="index.html" class="mobile-nav-link">TRANG CH·ª¶</a>
        <a href="products.html" class="mobile-nav-link">C·ª¨A H√ÄNG</a>
        <a href="diseases.html" class="mobile-nav-link">TRA C·ª®U B·ªÜNH</a>
        <a href="news.html" class="mobile-nav-link">TIN T·ª®C</a>
        <a href="contact.html" class="mobile-nav-link">LI√äN H·ªÜ</a>
        <a href="account.html" class="mobile-nav-link">T√ÄI KHO·∫¢N</a>
      </nav>
    </div>
  </div>

  <!-- Breadcrumb -->
  <div class="container mt-4">
    <div class="breadcrumb">
      <div class="breadcrumb-item"><a href="index.html" class="breadcrumb-link">Trang ch·ªß</a></div>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <div class="breadcrumb-item"><span class="breadcrumb-current">Gi·ªè h√†ng</span></div>
    </div>
  </div>

  <!-- Cart Content -->
  <div class="container mt-6 mb-12">
    <h1 class="text-3xl font-bold mb-8">Gi·ªè h√†ng c·ªßa b·∫°n</h1>

    <div id="cartContent">
      <!-- Cart will be rendered here -->
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2024 Mebipha. T·∫•t c·∫£ c√°c quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="utils.js"></script>
  <script src="data/products.js"></script>
  <script src="main.js"></script>

  <script>
    function renderCart() {
      const cartItems = Cart.getItems();
      const cartContent = document.getElementById('cartContent');

      if (cartItems.length === 0) {
        cartContent.innerHTML = `
          <div class="text-center p-12">
            <div style="font-size: 64px; margin-bottom: 20px; opacity: 0.3;">üõí</div>
            <h2 class="text-2xl font-semibold mb-3">Gi·ªè h√†ng tr·ªëng</h2>
            <p class="text-gray-600 mb-6">B·∫°n ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong gi·ªè h√†ng</p>
            <a href="products.html" class="btn btn-primary btn-lg">Ti·∫øp t·ª•c mua s·∫Øm</a>
            
            <div class="mt-12">
              <h3 class="text-xl font-semibold mb-6">S·∫£n ph·∫©m g·ª£i √Ω</h3>
              <div class="product-grid">
                ${getFeaturedProducts(4).map(product => `
                  <div class="product-card">
                    <div class="product-card-img-wrapper">
                      <img class="product-card-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Crect fill='%2386EFAC' width='400' height='400'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-size='16'%3E${encodeURIComponent(product.name.substring(0, 20))}%3C/text%3E%3C/svg%3E" alt="${product.name}">
                    </div>
                    <div class="product-card-body">
                      <div class="product-card-brand">${product.brand}</div>
                      <h3 class="product-card-title">${product.name}</h3>
                      <div class="product-card-price">${formatPrice(product.price)}</div>
                      <button class="btn btn-primary w-full mt-3" onclick="addToCart('${product.id}')">Th√™m v√†o gi·ªè</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>
        `;
        return;
      }

      // Render cart with items
      cartContent.innerHTML = `
        <div style="display: grid; grid-template-columns: 1fr 380px; gap: var(--space-8);">
          <!-- Cart Items -->
          <div>
            <div class="bg-white rounded-lg shadow-sm">
              <div class="p-6 border-b">
                <div style="display: grid; grid-template-columns: 100px 1fr 120px 120px 120px 50px; gap:var(--space-4); font-weight: 600; color: var(--color-gray-700);">
                  <div>H√¨nh ·∫£nh</div>
                  <div>S·∫£n ph·∫©m</div>
                  <div class="text-center">ƒê∆°n gi√°</div>
                  <div class="text-center">S·ªë l∆∞·ª£ng</div>
                  <div class="text-center">Th√†nh ti·ªÅn</div>
                  <div></div>
                </div>
              </div>
              
              <div class="divide-y">
                ${cartItems.map((item, index) => `
                  <div class="p-6">
                    <div style="display: grid; grid-template-columns: 100px 1fr 120px 120px 120px 50px; gap: var(--space-4); align-items: center;">
                      <div>
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Crect fill='%2386EFAC' width='100' height='100'/%3E%3C/svg%3E" alt="${item.name}" class="rounded-md">
                      </div>
                      <div>
                        <h3 class="font-semibold mb-1">${item.name}</h3>
                        ${item.variant ? `<p class="text-sm text-gray-600">Quy c√°ch: ${item.variant}</p>` : ''}
                      </div>
                      <div class="text-center font-semibold">${formatPrice(item.price)}</div>
                      <div class="d-flex align-center justify-center gap-2">
                        <button class="btn-icon btn-sm" onclick="updateCartQuantity(${index}, ${item.quantity - 1})">-</button>
                        <input type="number" class="form-input text-center" style="width: 60px;" value="${item.quantity}" min="1" onchange="updateCartQuantity(${index}, parseInt(this.value))">
                        <button class="btn-icon btn-sm" onclick="updateCartQuantity(${index}, ${item.quantity + 1})">+</button>
                      </div>
                      <div class="text-center font-bold text-primary">${formatPrice(item.price * item.quantity)}</div>
                      <div class="text-center">
                        <button class="btn-icon" onclick="removeCartItem(${index})" title="X√≥a">üóëÔ∏è</button>
                      </div>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="mt-6">
              <a href="products.html" class="btn btn-ghost">‚Üê Ti·∫øp t·ª•c mua s·∫Øm</a>
            </div>
          </div>

          <!-- Cart Summary -->
          <div>
            <div class="bg-white rounded-lg shadow-md p-6 sticky" style="top: 100px;">
              <h2 class="text-xl font-bold mb-6">T√≥m t·∫Øt ƒë∆°n h√†ng</h2>
              
              <div class="d-flex flex-column gap-4 mb-6">
                <div class="d-flex justify-between">
                  <span class="text-gray-600">T·∫°m t√≠nh</span>
                  <span class="font-semibold">${formatPrice(Cart.getTotal())}</span>
                </div>
                <div class="d-flex justify-between">
                  <span class="text-gray-600">Ph√≠ v·∫≠n chuy·ªÉn</span>
                  <span class="text-sm text-gray-500">T√≠nh sau</span>
                </div>
                <div class="border-t pt-4">
                  <div class="d-flex justify-between mb-2">
                    <span class="font-semibold">T·ªïng c·ªông</span>
                    <span class="text-2xl font-bold text-primary">${formatPrice(Cart.getTotal())}</span>
                  </div>
                  <p class="text-xs text-gray-500">ƒê√£ bao g·ªìm VAT (n·∫øu c√≥)</p>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label">M√£ gi·∫£m gi√°</label>
                <div class="d-flex gap-2">
                  <input type="text" class="form-input" placeholder="Nh·∫≠p m√£ gi·∫£m gi√°" id="couponCode">
                  <button class="btn btn-secondary" onclick="applyCoupon()">√Åp d·ª•ng</button>
                </div>
              </div>

              <button class="btn btn-primary btn-lg w-full" onclick="proceedToCheckout()">
                Ti·∫øn h√†nh thanh to√°n
              </button>

              <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-semibold mb-3 d-flex align-center gap-2">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="1" y="3" width="15" height="13"/>
                    <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/>
                    <circle cx="5.5" cy="18.5" r="2.5"/>
                    <circle cx="18.5" cy="18.5" r="2.5"/>
                  </svg>
                  Ch√≠nh s√°ch v·∫≠n chuy·ªÉn
                </h3>
                <ul class="text-sm text-gray-600 d-flex flex-column gap-2">
                  <li>‚úì Freeship ƒë∆°n t·ª´ 5 tri·ªáu</li>
                  <li>‚úì Giao h√†ng to√†n qu·ªëc</li>
                  <li>‚úì Ki·ªÉm tra h√†ng tr∆∞·ªõc khi nh·∫≠n</li>
                  <li>‚úì ƒê·ªïi tr·∫£ trong 7 ng√†y</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function updateCartQuantity(index, quantity) {
      if (quantity < 1) {
        removeCartItem(index);
        return;
      }
      Cart.update(index, quantity);
      renderCart();
      Toast.info('ƒê√£ c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng');
    }

    function removeCartItem(index) {
      Modal.confirm(
        'X√≥a s·∫£n ph·∫©m',
        'B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh·ªèi gi·ªè h√†ng?',
        () => {
          Cart.remove(index);
          renderCart();
          Toast.success('ƒê√£ x√≥a s·∫£n ph·∫©m');
        }
      );
    }

    function applyCoupon() {
      const code = document.getElementById('couponCode').value.trim();
      if (!code) {
        Toast.warning('Vui l√≤ng nh·∫≠p m√£ gi·∫£m gi√°');
        return;
      }

      // Mock coupon validation
      if (code.toUpperCase() === 'MEBIPHA2024') {
        Toast.success('ƒê√£ √°p d·ª•ng m√£ gi·∫£m gi√° 10%');
      } else {
        Toast.error('M√£ gi·∫£m gi√° kh√¥ng h·ª£p l·ªá');
      }
    }

    function proceedToCheckout() {
      const items = Cart.getItems();
      if (items.length === 0) {
        Toast.warning('Gi·ªè h√†ng tr·ªëng');
        return;
      }

      // Check if user is logged in
      if (!User.isLoggedIn()) {
        Modal.confirm(
          'ƒêƒÉng nh·∫≠p',
          'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c thanh to√°n. B·∫°n c√≥ mu·ªën ƒëƒÉng nh·∫≠p ngay?',
          () => {
            window.location.href = 'login.html?redirect=checkout.html';
          },
          () => {
            // Continue as guest (mock)
            Toast.info('Ti·∫øp t·ª•c v·ªõi t∆∞ c√°ch kh√°ch');
            setTimeout(() => {
              window.location.href = 'checkout.html';
            }, 1000);
          }
        );
      } else {
        window.location.href = 'checkout.html';
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      renderCart();
    });
  </script>
</body>

</html>